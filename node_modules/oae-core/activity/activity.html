<!-- CSS -->
<link rel="stylesheet" type="text/css" href="css/activity.css" />

<div class="activity-widget">
    <div id="activity-list-header"><!-- --></div>
    <ul class="oae-list"><!-- --></ul>
</div>

<div id="activity-list-header-template"><!--
    ${listHeader('__MSG__RECENT_ACTIVITY__', false, null, false)}
--></div>

<div id="activity-noresults-template"><!--
    <div class="alert alert-info">
        __MSG__NO_ACTIVITIES_OCCURRED_YET__
    </div>
--></div>

<div id="activity-items-template"><!--
    {macro renderSummary(activity)}
        <div class="activity-summary-container clearfix">
            <div class="pull-left activity-entity-thumbnail">
                ${renderThumbnail(activity.primaryActor)}
            </div>
            <div class="activity-summary">
                ${oae.api.i18n.translate(activity.summary.i18nKey, 'activity', activity.summary.i18nArguments)}
                <small class="muted"><time datetime="${activity.published}"></time></small>
            </div>
        </div>
    {/macro}

    {macro renderPreview(activity)}
        <div class="activity-preview-container">
            {if activity.activityItems.length === 1 && activity.activityItems[0].wideImageUrl}
                <ul class="row oae-list oae-list-grid activity-wide">
                    ${listItem(activity.activityItems[0], null, false, activity.activityItems[0].wideImageUrl, null, 'col-xs-12 col-lg-6')}
                </ul>
            {else}
                <ul class="row oae-list oae-list-grid" data-items="${activity.activityItems.length}">
                    {for item in activity.activityItems}
                        ${listItem(item, null, false, null, null, 'col-xs-6 col-sm-4 col-md-3 col-lg-2')}
                    {/for}
                </ul>
                <div class="text-center activity-show-all-toggle-container">
                    <a class="btn btn-link activity-show-all-toggle">__MSG__SHOW_ALL__</a>
                </div>
            {/if}
        </div>
    {/macro}

    {macro renderComments(activity)}
        {if activity.latestComments}
            <div class="activity-comment-container clearfix">
                <ul class="media-list">
                    {for comment in activity.latestComments}
                        <li class="media activity-level-${comment['oae:level']}">
                            <div class="pull-left activity-entity-thumbnail">
                                ${renderThumbnail(comment.author)}
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading">
                                    {if comment.author['oae:profilePath']}
                                        <a href="${comment.author['oae:profilePath']|profilePath}">${comment.author.displayName|encodeForHTML}</a>
                                    {else}
                                        ${comment.author.displayName|encodeForHTML}
                                    {/if}
                                    <small class="muted"><time datetime="${comment.published}"></time></small>
                                </h4>
                                ${oae.api.util.security().encodeForHTMLWithLinks(comment.content).replace(/\n/g, '<br/>')}
                            </div>
                        </li>
                    {/for}
                    {if activity.allComments.length > activity.latestComments.length}
                        <li class="media text-center">
                            <a href="${activity.originalActivity.target['oae:profilePath']}">__MSG__SHOW_ALL__</a>
                        </li>
                    {/if}
                </ul>
            </div>
        {/if}
    {/macro}

    {macro renderAnnotations(activity)}
        {if activity.latestAnnotations}
            <div class="activity-annotations-container clearfix">
                <ul class="media-list">
                    {for annotation in activity.latestAnnotations}
                        <li class="media">
                            <div class="pull-left activity-entity-thumbnail">
                                ${renderThumbnail(annotation.author)}
                            </div>
                            <div class="media-body">
                                {if annotation.author['oae:profilePath']}
                                    <a href="${annotation.author['oae:profilePath']|profilePath}">${annotation.author.displayName|encodeForHTML}</a>
                                {else}
                                    ${annotation.author.displayName|encodeForHTML}
                                {/if}

                                annotated

                                <q>${annotation.quote}</q><br />
                                ${oae.api.util.security().encodeForHTMLWithLinks(annotation.text)}
                            </div>
                        </li>
                    {/for}
                    {if activity.allAnnotations.length > activity.latestAnnotations.length}
                        <li class="media text-center">
                            <a href="${activity.originalActivity.target['oae:profilePath']}">__MSG__SHOW_ALL__</a>
                        </li>
                    {/if}
                </ul>
            </div>
        {/if}
    {/macro}

    {for activity in results}
        <li data-id="${activity.id}">
            <div class="well">
                ${renderSummary(activity)}
                ${renderPreview(activity)}
                ${renderComments(activity)}
                ${renderAnnotations(activity)}
            </div>
        </li>
    {/for}
--></div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="js/activity.js"></script>
